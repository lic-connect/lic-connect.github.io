<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIC Jeevan Umang (Plan 745) Premium Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #f4f7f9; margin: 0; padding: 20px; padding-bottom: 120px; }
        .container { background-color: #fff; padding: 25px 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); max-width: 600px; width: 100%; margin: auto; }
        h1 { color: #005691; text-align: center; margin-top: 0; margin-bottom: 25px; border-bottom: 2px solid #e0e0e0; padding-bottom: 15px; }
        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: 600; color: #333; margin-bottom: 8px; }
        input[type="number"], select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; font-size: 16px; box-sizing: border-box; }
        .checkbox-group { display: flex; align-items: center; gap: 10px; }
        input[type="checkbox"] { width: 18px; height: 18px; }
        button { width: 100%; padding: 12px; background-color: #007bff; color: white; border: none; border-radius: 5px; font-size: 18px; font-weight: bold; cursor: pointer; transition: background-color 0.3s; }
        button:hover { background-color: #0056b3; }
        #results { margin-top: 25px; }
        .results-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px; }
        .result-card { background-color: #f9f9f9; padding: 15px; border-radius: 5px; border-left: 4px solid #007bff; }
        .result-card h3 { margin-top: 0; color: #007bff; font-size: 1rem; }
        .result-card p { margin: 5px 0; font-size: 1rem; color: #555; }
        .result-card p span { font-weight: bold; color: #333; }
        #error-message { color: #d93025; background-color: #f8d7da; border: 1px solid #f5c6cb; padding: 10px; border-radius: 5px; margin-top: 20px; display: none; text-align: center; }

        /* --- STYLES FOR RIDER BUTTONS AND MODAL --- */
      /* --- Replace it with this --- */
.rider-button-container {
    /* "position: fixed" and related lines are now removed */
    display: flex;
    gap: 15px;
 margin-top: 15px;
}
        .rider-btn { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; border: none; border-radius: 10px; padding: 2px 30px; cursor: pointer; transition: all 0.3s ease; flex: 1;}
        #pwb-btn { background: linear-gradient(145deg, #007bff, #0056b3); color: white; box-shadow: 0 5px 15px rgba(0, 91, 179, 0.4); }
        #pwb-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0, 91, 179, 0.5); }
        #term-rider-btn { background: linear-gradient(145deg, #d9534f, #c9302c); color: white; box-shadow: 0 5px 15px rgba(201, 48, 44, 0.4); }
        #term-rider-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(201, 48, 44, 0.5); }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); display: none; align-items: center; justify-content: center; z-index: 2000; }
        .modal-content { background: #fff; padding: 30px; border-radius: 10px; width: 90%; max-width: 500px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.3); position: relative; }
        .modal-close-btn { position: absolute; top: 10px; right: 15px; font-size: 28px; font-weight: bold; color: #888; cursor: pointer; }
        #modal-title { margin-top: 0; }
        #modal-body { font-size: 1.1em; color: #333; }
    </style>
</head>
<body>

<div class="container">
    <h1>LIC Jeevan Umang (Plan 745)</h1>
    <form id="premium-form" onsubmit="return false;">
        <div class="form-group">
            <label for="age">Age at Entry (Nearest Birthday)</label>
            <input type="number" id="age" min="0" max="55" value="30" required>
        </div>
        <div class="form-group">
            <label for="sum-assured">Basic Sum Assured</label>
            <input type="number" id="sum-assured" min="200000" step="25000" value="500000" required>
        </div>
        <div class="form-group">
            <label for="ppt">Premium Paying Term (PPT)</label>
            <select id="ppt" class="form-select" required>
                <option value="15">15 Years</option>
                <option value="20" selected>20 Years</option>
                <option value="25">25 Years</option>
                <option value="30">30 Years</option>
            </select>
        </div>
        <div class="form-group checkbox-group">
            <input type="checkbox" id="addb-rider" checked>
            <label for="addb-rider" style="margin-bottom: 0;">Include Accidental Benefit (ADDB) Rider?</label>
        </div>
        <button type="button" onclick="calculatePremium()">Calculate Premium</button>
<div class="rider-button-container">
    <button id="pwb-btn" class="rider-btn">Know Your PWB Premium</button>
    <button id="term-rider-btn" class="rider-btn">Know Your Term Rider Premium</button>
</div>
    </form>
    <div id="error-message"></div>
    <div id="results"></div>
</div>

<!-- Buttons and Modal HTML -->

<div id="rider-modal" class="modal-overlay">
    <div class="modal-content">
        <span class="modal-close-btn">Ã—</span>
        <h2 id="modal-title"></h2>
        <div id="modal-body"></div>
    </div>
</div>

<script>
    // --- DATA STORE ---
    const tp745Data = [ {"Age":0,"T15":0,"T20":58.2,"T25":43.4,"T30":34.3},{"Age":1,"T15":0,"T20":58.2,"T25":43.4,"T30":34.3},{"Age":2,"T15":0,"T20":58.2,"T25":43.4,"T30":34.3},{"Age":3,"T15":84.4,"T20":58.2,"T25":43.4,"T30":34.3},{"Age":4,"T15":84.4,"T20":58.2,"T25":43.4,"T30":34.3},{"Age":5,"T15":84.4,"T20":58.2,"T25":43.4,"T30":34.3},{"Age":6,"T15":84.4,"T20":58.2,"T25":43.4,"T30":34.35},{"Age":7,"T15":84.4,"T20":58.2,"T25":43.4,"T30":34.4},{"Age":8,"T15":84.4,"T20":58.2,"T25":43.4,"T30":34.45},{"Age":9,"T15":84.4,"T20":58.2,"T25":43.4,"T30":34.5},{"Age":10,"T15":84.4,"T20":58.2,"T25":43.45,"T30":34.55},{"Age":11,"T15":84.4,"T20":58.2,"T25":43.5,"T30":34.6},{"Age":12,"T15":84.4,"T20":58.2,"T25":43.5,"T30":34.65},{"Age":13,"T15":84.4,"T20":58.2,"T25":43.55,"T30":34.7},{"Age":14,"T15":84.4,"T20":58.2,"T25":43.55,"T30":34.7},{"Age":15,"T15":84.4,"T20":58.2,"T25":43.55,"T30":34.75},{"Age":16,"T15":84.4,"T20":58.2,"T25":43.55,"T30":34.8},{"Age":17,"T15":84.4,"T20":58.2,"T25":43.55,"T30":34.8},{"Age":18,"T15":84.4,"T20":58.2,"T25":43.55,"T30":34.85},{"Age":19,"T15":84.4,"T20":58.2,"T25":43.55,"T30":34.85},{"Age":20,"T15":84.4,"T20":58.2,"T25":43.55,"T30":34.9},{"Age":21,"T15":84.4,"T20":58.2,"T25":43.55,"T30":34.95},{"Age":22,"T15":84.4,"T20":58.2,"T25":43.55,"T30":35},{"Age":23,"T15":84.4,"T20":58.2,"T25":43.55,"T30":35.05},{"Age":24,"T15":84.4,"T20":58.2,"T25":43.55,"T30":35.1},{"Age":25,"T15":84.4,"T20":58.2,"T25":43.55,"T30":35.2},{"Age":26,"T15":84.4,"T20":58.2,"T25":43.6,"T30":35.3},{"Age":27,"T15":84.4,"T20":58.2,"T25":43.65,"T30":35.4},{"Age":28,"T15":84.4,"T20":58.2,"T25":43.7,"T30":35.55},{"Age":29,"T15":84.4,"T20":58.2,"T25":43.75,"T30":35.7},{"Age":30,"T15":84.4,"T20":58.2,"T25":43.85,"T30":35.85},{"Age":31,"T15":84.4,"T20":58.2,"T25":43.95,"T30":36.05},{"Age":32,"T15":84.4,"T20":58.2,"T25":44.1,"T30":36.25},{"Age":33,"T15":84.4,"T20":58.2,"T25":44.25,"T30":36.5},{"Age":34,"T15":84.4,"T20":58.2,"T25":44.45,"T30":36.8},{"Age":35,"T15":84.4,"T20":58.2,"T25":44.65,"T30":37.1},{"Age":36,"T15":84.4,"T20":58.2,"T25":44.85,"T30":37.4},{"Age":37,"T15":84.4,"T20":58.2,"T25":45.1,"T30":37.75},{"Age":38,"T15":84.4,"T20":58.2,"T25":45.4,"T30":38.15},{"Age":39,"T15":84.4,"T20":58.3,"T25":45.75,"T30":38.6},{"Age":40,"T15":84.4,"T20":58.55,"T25":46.1,"T30":39.1},{"Age":41,"T15":84.4,"T20":58.8,"T25":46.5,"T30":0},{"Age":42,"T15":84.4,"T20":59.1,"T25":46.95,"T30":0},{"Age":43,"T15":84.4,"T20":59.45,"T25":47.45,"T30":0},{"Age":44,"T15":84.4,"T20":59.8,"T25":47.95,"T30":0},{"Age":45,"T15":84.4,"T20":60.25,"T25":48.55,"T30":0},{"Age":46,"T15":84.4,"T20":60.7,"T25":0,"T30":0},{"Age":47,"T15":84.4,"T20":61.2,"T25":0,"T30":0},{"Age":48,"T15":84.4,"T20":61.8,"T25":0,"T30":0},{"Age":49,"T15":84.4,"T20":62.4,"T25":0,"T30":0},{"Age":50,"T15":84.5,"T20":63.1,"T25":0,"T30":0},{"Age":51,"T15":84.95,"T20":0,"T25":0,"T30":0},{"Age":52,"T15":85.45,"T20":0,"T25":0,"T30":0},{"Age":53,"T15":86,"T20":0,"T25":0,"T30":0},{"Age":54,"T15":86.6,"T20":0,"T25":0,"T30":0},{"Age":55,"T15":87.2,"T20":0,"T25":0,"T30":0}];
    const addb745Data=[{"Age":15,"T15":1,"T20":1.3,"T25":1.25,"T30":1.2},{"Age":16,"T15":1.05,"T20":1.25,"T25":1.3,"T30":1.35},{"Age":17,"T15":1.1,"T20":1.3,"T25":1.35,"T30":1.4},{"Age":18,"T15":1.7,"T20":1.45,"T25":1.3,"T30":1.2},{"Age":19,"T15":1.7,"T20":1.45,"T25":1.3,"T30":1.2},{"Age":20,"T15":1.7,"T20":1.45,"T25":1.3,"T30":1.2},{"Age":21,"T15":1.7,"T20":1.45,"T25":1.3,"T30":1.2},{"Age":22,"T15":1.7,"T20":1.4,"T25":1.25,"T30":1.2},{"Age":23,"T15":1.7,"T20":1.4,"T25":1.25,"T30":1.15},{"Age":24,"T15":1.7,"T20":1.4,"T25":1.25,"T30":1.15},{"Age":25,"T15":1.65,"T20":1.4,"T25":1.25,"T30":1.15},{"Age":26,"T15":1.65,"T20":1.4,"T25":1.25,"T30":1.15},{"Age":27,"T15":1.65,"T20":1.4,"T25":1.25,"T30":1.15},{"Age":28,"T15":1.65,"T20":1.4,"T25":1.25,"T30":1.15},{"Age":29,"T15":1.65,"T20":1.35,"T25":1.2,"T30":1.15},{"Age":30,"T15":1.6,"T20":1.35,"T25":1.2,"T30":1.1},{"Age":31,"T15":1.6,"T20":1.35,"T25":1.2,"T30":1.1},{"Age":32,"T15":1.6,"T20":1.35,"T25":1.2,"T30":1.1},{"Age":33,"T15":1.6,"T20":1.35,"T25":1.2,"T30":1.1},{"Age":34,"T15":1.55,"T20":1.3,"T25":1.2,"T30":1.1},{"Age":35,"T15":1.55,"T20":1.3,"T25":1.15,"T30":1.1},{"Age":36,"T15":1.55,"T20":1.3,"T25":1.15,"T30":1.05},{"Age":37,"T15":1.5,"T20":1.3,"T25":1.15,"T30":1.05},{"Age":38,"T15":1.5,"T20":1.25,"T25":1.15,"T30":1.05},{"Age":39,"T15":1.5,"T20":1.25,"T25":1.1,"T30":1.05},{"Age":40,"T15":1.45,"T20":1.25,"T25":1.1,"T30":1},{"Age":41,"T15":1.45,"T20":1.2,"T25":1.1,"T30":1.15},{"Age":42,"T15":1.45,"T20":1.2,"T25":1.05,"T30":1.15},{"Age":43,"T15":1.4,"T20":1.2,"T25":1.05,"T30":1.15},{"Age":44,"T15":1.4,"T20":1.15,"T25":1.05,"T30":1.15},{"Age":45,"T15":1.35,"T20":1.15,"T25":1,"T30":"1.15"},{"Age":46,"T15":1.35,"T20":1.1,"T25":1.25,"T30":"1.15"},{"Age":47,"T15":1.3,"T20":1.1,"T25":1.25,"T30":"1.15"},{"Age":48,"T15":1.25,"T20":1.05,"T25":1.25,"T30":1.2},{"Age":49,"T15":1.25,"T20":1.05,"T25":1.3,"T30":1.2},{"Age":50,"T15":1.2,"T20":1,"T25":1.3,"T30":1.2},{"Age":51,"T15":1.2,"T20":1.55,"T25":1.3,"T30":1.2},{"Age":52,"T15":1.15,"T20":1.55,"T25":1.3,"T30":1.2}];
    const rawPwbRates=[{"T1":1.7,"T2":1.7,"T3":1.85,"T4":2.1,"T5":2.45,"T6":3.1,"T7":"4.10","Term":5},{"T1":1.8,"T2":1.85,"T3":1.95,"T4":2.25,"T5":2.7,"T6":3.55,"T7":"4.80","Term":6},{"T1":1.9,"T2":1.9,"T3":2.1,"T4":2.4,"T5":2.95,"T6":4,"T7":"5.55","Term":7},{"T1":1.95,"T2":2,"T3":2.2,"T4":2.6,"T5":3.25,"T6":4.5,"T7":"6.30","Term":8},{"T1":2,"T2":2.1,"T3":2.3,"T4":2.8,"T5":3.6,"T6":5,"T7":"7.05","Term":9},{"T1":2.2,"T2":2.25,"T3":2.55,"T4":3.1,"T5":4.05,"T6":5.75,"T7":"8.15","Term":10},{"T1":2.25,"T2":2.4,"T3":2.65,"T4":3.3,"T5":4.4,"T6":6.35,"T7":"9.00","Term":11},{"T1":2.3,"T2":2.45,"T3":2.8,"T4":3.5,"T5":4.8,"T6":6.9,"T7":"9.85","Term":12},{"T1":2.45,"T2":2.55,"T3":2.95,"T4":3.75,"T5":5.15,"T6":7.5,"T7":"10.70","Term":13},{"T1":2.5,"T2":2.7,"T3":3.1,"T4":4,"T5":5.55,"T6":8.15,"T7":"11.60","Term":14},{"T1":2.6,"T2":2.8,"T3":3.3,"T4":4.35,"T5":6.1,"T6":8.9,"T7":"12.75","Term":15},{"T1":2.7,"T2":2.9,"T3":3.5,"T4":4.6,"T5":6.5,"T6":9.55,"T7":"13.70","Term":16},{"T1":2.8,"T2":3.05,"T3":3.65,"T4":4.9,"T5":7,"T6":10.25,"T7":"14.70","Term":17},{"T1":2.85,"T2":3.15,"T3":3.85,"T4":5.2,"T5":7.45,"T6":10.95,"T7":"15.75","Term":18},{"T1":2.9,"T2":3.3,"T3":4.05,"T4":5.5,"T5":7.95,"T6":11.65,"T7":"16.80","Term":19},{"T1":3.05,"T2":3.45,"T3":4.25,"T4":5.85,"T5":8.4,"T6":12.35,"T7":null,"Term":20},{"T1":3.1,"T2":3.55,"T3":4.45,"T4":6.15,"T5":8.95,"T6":13.1,"T7":null,"Term":21},{"T1":3.2,"T2":3.7,"T3":4.7,"T4":6.5,"T5":9.45,"T6":13.85,"T7":null,"Term":22},{"T1":3.35,"T2":3.85,"T3":4.9,"T4":6.9,"T5":10,"T6":14.65,"T7":null,"Term":23},{"T1":3.4,"T2":4,"T3":5.15,"T4":7.25,"T5":10.5,"T6":15.45,"T7":null,"Term":24},{"T1":3.5,"T2":4.15,"T3":5.4,"T4":7.65,"T5":11.05,"T6":null,"T7":null,"Term":25}];
    const rawTermRiderRates=[{"Age":18,"Rider_Term":35,"T15":3.27,"T20":2.75,"T25":2.46,"T30":2.28},{"Age":19,"Rider_Term":35,"T15":3.43,"T20":2.88,"T25":2.57,"T30":2.39},{"Age":20,"Rider_Term":35,"T15":3.59,"T20":3.02,"T25":2.7,"T30":2.5},{"Age":21,"Rider_Term":35,"T15":3.78,"T20":3.18,"T25":2.84,"T30":2.64},{"Age":22,"Rider_Term":35,"T15":3.99,"T20":3.36,"T25":3,"T30":2.78},{"Age":23,"Rider_Term":35,"T15":4.22,"T20":3.55,"T25":3.18,"T30":2.95},{"Age":24,"Rider_Term":35,"T15":4.48,"T20":3.77,"T25":3.37,"T30":3.13},{"Age":25,"Rider_Term":35,"T15":4.76,"T20":4.01,"T25":3.59,"T30":3.33},{"Age":26,"Rider_Term":35,"T15":5.08,"T20":4.27,"T25":3.82,"T30":3.55},{"Age":27,"Rider_Term":35,"T15":5.42,"T20":4.56,"T25":4.08,"T30":3.79},{"Age":28,"Rider_Term":35,"T15":5.79,"T20":4.88,"T25":4.37,"T30":4.06},{"Age":29,"Rider_Term":35,"T15":6.2,"T20":5.22,"T25":4.68,"T30":4.35},{"Age":30,"Rider_Term":35,"T15":6.64,"T20":5.6,"T25":5.02,"T30":4.67},{"Age":31,"Rider_Term":35,"T15":7.13,"T20":6,"T25":5.38,"T30":5.01},{"Age":32,"Rider_Term":35,"T15":7.65,"T20":6.45,"T25":5.79,"T30":5.39},{"Age":33,"Rider_Term":35,"T15":8.22,"T20":6.93,"T25":6.22,"T30":5.8},{"Age":34,"Rider_Term":35,"T15":8.83,"T20":7.45,"T25":6.7,"T30":6.25},{"Age":35,"Rider_Term":35,"T15":9.5,"T20":8.02,"T25":7.21,"T30":6.73},{"Age":36,"Rider_Term":35,"T15":10.21,"T20":8.63,"T25":7.77,"T30":7.26},{"Age":37,"Rider_Term":35,"T15":10.99,"T20":9.3,"T25":8.37,"T30":7.83},{"Age":38,"Rider_Term":35,"T15":11.83,"T20":10.01,"T25":9.03,"T30":8.45},{"Age":39,"Rider_Term":35,"T15":12.74,"T20":10.79,"T25":9.74,"T30":9.13},{"Age":40,"Rider_Term":35,"T15":13.71,"T20":11.63,"T25":10.51,"T30":9.86},{"Age":41,"Rider_Term":34,"T15":14.3,"T20":12.14,"T25":10.98,"T30":null},{"Age":42,"Rider_Term":33,"T15":14.89,"T20":12.66,"T25":11.46,"T30":null},{"Age":43,"Rider_Term":32,"T15":15.51,"T20":13.19,"T25":11.96,"T30":null},{"Age":44,"Rider_Term":31,"T15":16.14,"T20":13.76,"T25":12.49,"T30":null},{"Age":45,"Rider_Term":30,"T15":16.8,"T20":14.34,"T25":13.04,"T30":null},{"Age":46,"Rider_Term":29,"T15":17.49,"T20":14.94,"T25":null,"T30":null},{"Age":47,"Rider_Term":28,"T15":18.18,"T20":15.56,"T25":null,"T30":null},{"Age":48,"Rider_Term":27,"T15":18.9,"T20":16.19,"T25":null,"T30":null},{"Age":49,"Rider_Term":26,"T15":19.61,"T20":16.84,"T25":null,"T30":null},{"Age":50,"Rider_Term":25,"T15":20.33,"T20":17.48,"T25":null,"T30":null},{"Age":51,"Rider_Term":24,"T15":21.04,"T20":null,"T25":null,"T30":null},{"Age":52,"Rider_Term":23,"T15":21.74,"T20":null,"T25":null,"T30":null},{"Age":53,"Rider_Term":22,"T15":22.41,"T20":null,"T25":null,"T30":null},{"Age":54,"Rider_Term":21,"T15":23.06,"T20":null,"T25":null,"T30":null},{"Age":55,"Rider_Term":20,"T15":23.67,"T20":null,"T25":null,"T30":null}];
    
    // --- DATA PROCESSING ---
    const baseRates = tp745Data.reduce((acc, item) => { acc[item.Age] = { 15: item.T15, 20: item.T20, 25: item.T25, 30: item.T30 }; return acc; }, {});
    const addbRates = addb745Data.reduce((acc, item) => { acc[item.Age] = { 15: parseFloat(item.T15) || 0, 20: parseFloat(item.T20) || 0, 25: parseFloat(item.T25) || 0, 30: parseFloat(item.T30) || 0 }; return acc; }, {});
    const pwbRates = rawPwbRates.reduce((acc, item) => { acc[item.Term] = { T1: parseFloat(item.T1) || 0, T2: parseFloat(item.T2) || 0, T3: parseFloat(item.T3) || 0, T4: parseFloat(item.T4) || 0, T5: parseFloat(item.T5) || 0, T6: parseFloat(item.T6) || 0, T7: parseFloat(item.T7) || 0 }; return acc; }, {});
    const termRiderRates = rawTermRiderRates.reduce((acc, item) => { acc[item.Age] = { 15: item.T15, 20: item.T20, 25: item.T25, 30: item.T30 }; return acc; }, {});
    
    // --- ALL HELPER FUNCTIONS ---
    const formatINR = (val) => `â‚¹ ${new Intl.NumberFormat('en-IN').format(Math.round(val))}`;
    function showError(message) { const e = document.getElementById('error-message'); e.textContent = message; e.style.display = 'block'; }
    function validateInputs(age, sumAssured, ppt) {
        if (isNaN(age) || isNaN(sumAssured) || isNaN(ppt)) { showError("Please fill all required fields."); return false; }
        if (sumAssured < 200000) { showError("Minimum Sum Assured is â‚¹2,00,000."); return false; }
        if (sumAssured % 25000 !== 0) { showError("Sum Assured must be in multiples of 25,000."); return false; }
        const maxEntryAgeMap = { 15: 55, 20: 50, 25: 45, 30: 40 };
        if (age > maxEntryAgeMap[ppt]) { showError(`Maximum entry age for ${ppt} year PPT is ${maxEntryAgeMap[ppt]} years.`); return false; }
        const ageAtPptEnd = age + ppt;
        if (age > 0 && (ageAtPptEnd < 30 || ageAtPptEnd > 70)) { showError(`Age at the end of PPT must be between 30 and 70. Your combination results in age ${ageAtPptEnd}.`); return false; }
        return true;
    }
   // function getHighSaRebateRate(sumAssured) { if (sumAssured >= 500000) return 2.50; return 0; }



// --- REPLACE THE OLD FUNCTION WITH THIS NEW ONE ---
function getHighSaRebateRate(sumAssured) {
    const isAddbSelected = document.getElementById('addb-rider').checked;

    if (isAddbSelected) {
        // --- SET 1: Rates for when ADDB is CHECKED ---
        // ** IMPORTANT: Replace these example rates with your actual values! **
        if (sumAssured >= 2500000) {      // 25 Lakhs and above
            return 4.00; // Example Rate
        } else if (sumAssured >= 1000000) { // 10 Lakhs to 24,99,999
            return 3.50; // Example Rate
        } else if (sumAssured >= 500000) {  // 5 Lakhs to 9,99,999
            return 2.50; // Example Rate
        }
        return 0; // Nil rebate for sums below 5,00,000

    } else {
        // --- SET 2: Rates for when ADDB is NOT CHECKED ---
        if (sumAssured >= 2500000) {      // 25 Lakhs and above
            return 4.00;
        } else if (sumAssured >= 1000000) { // 10 Lakhs to 24,99,999
            return 3.50;
        } else if (sumAssured >= 500000) {  // 5 Lakhs to 9,99,999
            return 2.50;
        }
        return 0; // Nil rebate for sums below 5,00,000
    }
}





    // --- MAIN CALCULATOR ---
    function calculatePremium() {
        const errorDiv = document.getElementById('error-message');
        const resultsDiv = document.getElementById('results');
        errorDiv.style.display = 'none';
        resultsDiv.innerHTML = ''; // Clear previous results

        const age = parseInt(document.getElementById('age').value);
        const sumAssured = parseFloat(document.getElementById('sum-assured').value);
        const ppt = parseInt(document.getElementById('ppt').value);
        const includeAddbRider = document.getElementById('addb-rider').checked;

        if (!validateInputs(age, sumAssured, ppt)) return;

        const tabularRate = baseRates[age]?.[ppt];
        if (!tabularRate || tabularRate <= 0) { showError(`This combination of Age (${age}) and PPT (${ppt}) is not available.`); return; }

        const annualTabularPremium = (sumAssured / 1000) * tabularRate;
        const annualSaRebateAmount = (sumAssured / 1000) * getHighSaRebateRate(sumAssured);

        let annualAddbPremium = 0;
        if (includeAddbRider && age >= 18) {
            const addbRate = addbRates[age]?.[ppt];
            if (addbRate > 0) {
                annualAddbPremium = (Math.min(sumAssured, 10000000) / 1000) * addbRate;
            }
        }

        const netAnnualPremiumForLoading = annualTabularPremium - annualSaRebateAmount + annualAddbPremium;
        const modeRebateForYearly = annualTabularPremium * 0.02;
        const netYearlyPremium = annualTabularPremium - annualSaRebateAmount - modeRebateForYearly + annualAddbPremium;

        const premiums = {
            yearly: netYearlyPremium,
            "half-yearly": netAnnualPremiumForLoading * 0.49475,
            quarterly: netAnnualPremiumForLoading * 0.2500,
            monthly: netAnnualPremiumForLoading * 0.0833
        };

        const policyTerm = 100 - age;
        
        let resultsHTML = `
            <div class="result-card mb-3" style="border-color: #28a745;">
                 <p class="mb-1"><strong>Policy Term:</strong> <span>${policyTerm} Years</span></p>
                 <p class="mb-0"><strong>Annual Survival Benefit (after PPT):</strong> <span>${formatINR(sumAssured * 0.08)}</span></p>
            </div>
            <div id="premium-results" class="results-grid"></div>`;
        resultsDiv.innerHTML = resultsHTML;

        let premiumResultsHTML = '';
        const modes = { yearly: "Yearly", "half-yearly": "Half-Yearly", quarterly: "Quarterly", monthly: "Monthly (NACH)" };

        for (const modeKey in modes) {
            const premiumBeforeTax = premiums[modeKey];
            const finalPremium1stYear = Math.round(premiumBeforeTax * 1.045);
            const finalPremium2ndYear = Math.round(premiumBeforeTax * 1.0225);

            premiumResultsHTML += `
                <div class="result-card">
                    <h3>${modes[modeKey]} Mode</h3>
                    <p>1st Year Premium: <span>${formatINR(finalPremium1stYear)}</span></p>
                    <p>2nd Year Onwards: <span>${formatINR(finalPremium2ndYear)}</span></p>
                </div>`;
        }
        document.getElementById('premium-results').innerHTML = premiumResultsHTML;
        resultsDiv.style.display = 'block';
    }

    // --- RIDER AND MODAL LOGIC ---
    const modal = document.getElementById('rider-modal');
    const modalTitle = document.getElementById('modal-title');
    const modalBody = document.getElementById('modal-body');
    const closeModalBtn = document.querySelector('.modal-close-btn');

    function showModal(title, bodyHtml) { modalTitle.innerHTML = title; modalBody.innerHTML = bodyHtml; modal.style.display = 'flex'; }
    function hideModal() { modal.style.display = 'none'; }
    closeModalBtn.addEventListener('click', hideModal);
    window.addEventListener('click', (event) => { if (event.target === modal) hideModal(); });

    function getBaseAnnualPremium() {
        const age = parseInt(document.getElementById('age').value);
        const sumAssured = parseFloat(document.getElementById('sum-assured').value);
        const ppt = parseInt(document.getElementById('ppt').value);
        if (!validateInputs(age, sumAssured, ppt)) return null;
        const tabularRate = baseRates[age]?.[ppt];
        if (!tabularRate) return null;
        const annualTabularPremium = (sumAssured / 1000) * tabularRate;
        const saRebateRate = getHighSaRebateRate(sumAssured);
        const annualSaRebateAmount = (sumAssured / 1000) * saRebateRate;
        const modeRebateAmount = annualTabularPremium * 0.02;
        return annualTabularPremium - annualSaRebateAmount - modeRebateAmount;
    }

    document.getElementById('pwb-btn').addEventListener('click', () => {
        showModal('PWB Rider Premium', `<label for="proposer-age" class="form-label">Enter Proposer's Age (18-55)</label><input type="number" id="proposer-age" class="form-control mb-3" value="30" min="18" max="55"><button class="btn btn-primary w-100" onclick="calculatePwbFromModal()">Calculate PWB Premium</button>`);
    });

    function getPwbTier(proposerAge) { if (proposerAge <= 25) return 'T1'; if (proposerAge <= 30) return 'T2'; if (proposerAge <= 35) return 'T3'; if (proposerAge <= 40) return 'T4'; if (proposerAge <= 45) return 'T5'; if (proposerAge <= 50) return 'T6'; if (proposerAge <= 55) return 'T7'; return null; }

    function calculatePwbFromModal() {
        const lifeAssuredAge = parseInt(document.getElementById("age").value);
        const ppt = parseInt(document.getElementById("ppt").value);
        const proposerAge = parseInt(document.getElementById("proposer-age").value);
        const baseAnnualPremium = getBaseAnnualPremium();

        if (baseAnnualPremium === null) { showModal('Error', '<p class="text-danger">Could not calculate base premium. Check main inputs.</p>'); return; }
        if (isNaN(proposerAge) || proposerAge < 18 || proposerAge > 55) { showModal('Error', '<p class="text-danger">Enter a valid Proposer Age (18-55).</p>'); return; }
        if (lifeAssuredAge > 0 && proposerAge <= lifeAssuredAge) { showModal('Validation Error', `<p class="text-danger">Proposer's Age (<b>${proposerAge}</b>) must be greater than Life Assured's Age (<b>${lifeAssuredAge}</b>).</p>`); return; }
        const pwbTier = getPwbTier(proposerAge);
        const pwbRate = pwbRates[ppt]?.[pwbTier];
        if (!pwbRate) { showModal('PWB Not Available', `<p class="text-danger">PWB is not available for this Proposer Age and PPT.</p>`); return; }






        //const finalPwbPremium = (baseAnnualPremium * pwbRate) / 1000;
const sumAssured = parseFloat(document.getElementById("sum-assured").value);
//const finalPwbPremium = (sumAssured * pwbRate) / 1000;


//const finalPwbPremium = ((parseFloat(document.getElementById('sum-assured').value) / 1000) * baseRates[parseInt(document.getElementById('age').value)][parseInt(document.getElementById('ppt').value)]) * (pwbRate / 100);

//const finalPwbPremium = (getBaseAnnualPremium() * pwbRate) / 100;

//const finalPwbPremium = ((parseFloat(document.getElementById('sum-assured').value) / 1000) * baseRates[parseInt(document.getElementById('age').value)][parseInt(document.getElementById('ppt').value)]) * (pwbRate / 100) * 0.637;

const finalPwbPremium = (baseAnnualPremium * pwbRate) / 100 * 0.64;
        showModal('Standalone PWB Premium', `<p class="fs-4 fw-bold">${formatINR(finalPwbPremium)}</p><small>(Yearly Premium, Excluding Tax)</small>`);
    }

    document.getElementById('term-rider-btn').addEventListener('click', () => {
        const baseSa = parseFloat(document.getElementById("sum-assured").value);
        showModal('Term Rider Premium', `<label for="termRiderSA" class="form-label">Term Rider Sum Assured</label><p style="font-size:0.8em; color:#6c757d; margin-top:0;">(Cannot exceed Base SA of ${formatINR(baseSa)})</p><input type="number" id="termRiderSA" class="form-control mb-3" value="${baseSa}" /><button onclick="calculateTermRiderFromModal()" class="btn btn-danger w-100">Calculate Rider Premium</button>`);
    });

    function calculateTermRiderFromModal() {
        const age = parseInt(document.getElementById("age").value);
        const ppt = parseInt(document.getElementById("ppt").value);
        const baseSumAssured = parseFloat(document.getElementById("sum-assured").value);
        const termRiderSumAssured = parseFloat(document.getElementById('termRiderSA').value);

        if (isNaN(termRiderSumAssured) || termRiderSumAssured <= 0) { showModal('Error', '<p class="text-danger">Enter a valid Sum Assured.</p>'); return; }
        if (termRiderSumAssured > baseSumAssured) { showModal('Validation Error', `<p class="text-danger">Rider SA cannot exceed Base SA of ${formatINR(baseSumAssured)}.</p>`); return; }
        
        const termRiderRate = termRiderRates[age]?.[ppt];
        if (!termRiderRate || termRiderRate === 0) { showModal('Term Rider Not Available', `<p class="text-danger">Term Rider is not available for this Age/PPT combination.</p>`); return; }
        
        const termRiderPremium = (termRiderSumAssured / 1000) * termRiderRate;
        const termRiderPremiumWithGst = termRiderPremium * 1.18;
        showModal('Standalone Term Rider Premium', `<p class="fs-4 fw-bold">${formatINR(termRiderPremiumWithGst)}</p><small>(Yearly Premium, inclusive of 18% GST)</small>`);
    }
</script>

</body>
</html>