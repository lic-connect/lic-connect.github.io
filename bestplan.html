<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Best plan for me???</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #ffffff;
            color: #333;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f7f7f7;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        h1, h2 {
            text-align: center;
            color: #00563f;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }

        .tool-section {
            margin-bottom: 40px;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
            font-size: 0.9em;
        }

        /* --- 3D Beveled Green Button/Input Style --- */
        .neumorphic-input, .neumorphic-button {
            border: none;
            padding: 12px 15px;
            font-size: 1em;
            color: #ffffff;
            border-radius: 12px;
            outline: none;
            transition: all 0.2s ease-in-out;
            background: linear-gradient(145deg, #4caf50, #409143);
            box-shadow: 5px 5px 10px #387d3b, -5px -5px 10px #58c55b;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            cursor: pointer;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }

        select.neumorphic-input {
            background-image: linear-gradient(145deg, #4caf50, #409143), 
                              url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat, repeat;
            background-position: right .7em top 50%, 0 0;
            background-size: .65em auto, 100%;
        }
        
        input.neumorphic-input[readonly], .neumorphic-input:disabled {
            background: linear-gradient(145deg, #6c757d, #5a6268);
            box-shadow: 5px 5px 10px #545b62, -5px -5px 10px #848d95;
            cursor: not-allowed;
        }

        .neumorphic-input:focus, .neumorphic-button:focus {
            box-shadow: inset 5px 5px 10px #387d3b, inset -5px -5px 10px #58c55b;
        }

        .neumorphic-button {
            display: block;
            width: 100%;
            max-width: 300px;
            margin: 30px auto 0;
            font-weight: bold;
        }
        
        .neumorphic-button:active {
            box-shadow: inset 7px 7px 14px #387d3b, inset -7px -7px 14px #58c55b;
            font-size: 0.98em;
        }

        /* Suggestion Output Styling */
        #planSuggestionOutput {
            margin-top: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }
        .suggestion-card {
            background: #fff;
            border: 1px solid #ddd;
            border-left: 5px solid #00563f;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
        }
        .suggestion-card h3 {
            margin-top: 0;
            color: #00563f;
        }
        .suggestion-card p {
            font-size: 0.95em;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        .suggestion-card .why-reason {
            margin-top: auto;
            padding-top: 10px;
            border-top: 1px dashed #ccc;
            font-style: italic;
            color: #555;
            font-size: 0.9em;
        }

        /* Comparison Table Styling */
        .comparison-section { margin-top: 40px; overflow-x: auto; }
        #comparisonTable { width: 100%; border-collapse: collapse; background: #fff; box-shadow: 0 4px 8px rgba(0,0,0,0.05); }
        #comparisonTable th, #comparisonTable td { padding: 12px 15px; border: 1px solid #ddd; text-align: left; vertical-align: top; }
        #comparisonTable thead th { background-color: #00563f; color: white; font-size: 1.1em; text-align: center; }
        #comparisonTable tbody th { background-color: #f2f2f2; font-weight: bold; width: 180px; }
        #comparisonTable td { line-height: 1.5; }
        .illustrative-example { font-style: italic; color: #444; }

    </style>
</head>
<body>

<div class="container">
    <h1>Best plan for me???</h1>

    <!-- SECTION 1: "Best Plan For Me?" Tool -->
    <div class="tool-section">
        <h2>Find the Right Plan for Your Needs</h2>
        <div class="input-grid" style="grid-template-columns: 1fr;">
            <div class="input-group">
                <label for="needsSelector">Select your primary financial need:</label>
                <select id="needsSelector" class="neumorphic-input"></select>
            </div>
        </div>
        <div id="planSuggestionOutput">
            <p style="text-align:center; color:#777; grid-column: 1 / -1;">Top 3 recommended plans will appear here.</p>
        </div>
    </div>

    <hr style="margin: 50px 0; border: 1px solid #e0e0e0;">

    <!-- SECTION 2: Plan Comparison -->
    <div class="tool-section">
        <h2>Plan Comparison Tool</h2>
        <div class="input-grid">
            <div class="input-group"><label for="planSelector1">Plan 1</label><select id="planSelector1" class="neumorphic-input"></select></div>
            <div class="input-group"><label for="planSelector2">Plan 2</label><select id="planSelector2" class="neumorphic-input"></select></div>
            <div class="input-group"><label for="planSelector3">Plan 3</label><select id="planSelector3" class="neumorphic-input"></select></div>
            <div class="input-group"><label for="planSelector4">Plan 4</label><select id="planSelector4" class="neumorphic-input"></select></div>
            <div class="input-group"><label for="planSelector5">Plan 5</label><select id="planSelector5" class="neumorphic-input"></select></div>
            
            <div class="input-group"><label>Plan No.</label><input type="text" id="planNumber1" class="neumorphic-input" readonly></div>
            <div class="input-group"><label>Plan No.</label><input type="text" id="planNumber2" class="neumorphic-input" readonly></div>
            <div class="input-group"><label>Plan No.</label><input type="text" id="planNumber3" class="neumorphic-input" readonly></div>
            <div class="input-group"><label>Plan No.</label><input type="text" id="planNumber4" class="neumorphic-input" readonly></div>
            <div class="input-group"><label>Plan No.</label><input type="text" id="planNumber5" class="neumorphic-input" readonly></div>
        </div>
        <button id="compareBtn" class="neumorphic-button">Compare Selected Plans</button>

        <div class="comparison-section">
            <table id="comparisonTable">
                <thead id="comparisonTableHead"></thead>
                <tbody id="comparisonTableBody"></tbody>
            </table>
        </div>
    </div>

    <hr style="margin: 50px 0; border: 1px solid #e0e0e0;">

    <!-- SECTION 3: Premium Calculator Mockup -->
    <div class="tool-section">
        <h2>Premium Calculator (UI Mockup)</h2>
        <div class="input-grid">
            <div class="input-group"><label>Common Sum Assured</label><input type="number" id="commonSA" class="neumorphic-input" placeholder="e.g., 500000"></div>
            <div class="input-group"><label>Common Age</label><input type="number" id="commonAge" class="neumorphic-input" placeholder="e.g., 35"></div>
            <div class="input-group"><label>Common Policy Term</label><input type="number" id="commonTerm" class="neumorphic-input" placeholder="e.g., 20"></div>
            <div class="input-group"><label>Common PPT</label><input type="number" id="commonPPT" class="neumorphic-input" placeholder="e.g., 15"></div>
        </div>
        <button id="calculatePremiumBtn" class="neumorphic-button">Calculate Premium</button>
        <div class="input-grid" style="margin-top: 30px;">
            <div class="input-group"><label>Plan 1 Premium</label><input type="text" id="premiumOutput1" class="neumorphic-input" readonly></div>
            <div class="input-group"><label>Plan 2 Premium</label><input type="text" id="premiumOutput2" class="neumorphic-input" readonly></div>
            <div class="input-group"><label>Plan 3 Premium</label><input type="text" id="premiumOutput3" class="neumorphic-input" readonly></div>
            <div class="input-group"><label>Plan 4 Premium</label><input type="text" id="premiumOutput4" class="neumorphic-input" readonly></div>
            <div class="input-group"><label>Plan 5 Premium</label><input type="text" id="premiumOutput5" class="neumorphic-input" readonly></div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // --- ENHANCED PLAN DATA with categorization and recommendation logic ---
    const planData = [
        // Endowment Plans
        { planName: "New Endowment", planNumber: "714", productSummary: "A classic with-profits endowment plan offering a good balance of savings and protection.", minSumAssured: "2,00,000", maxSumAssured: "NO LIMIT", minAge: "8 Years", maxAge: "50 Years", minTerm: "12 Years", maxTerm: "35 Years", ppt: "Same as Policy Term", deathBenefit: "Sum Assured + Vested Bonus + FAB. Higher of (SA on Death, 7x Annual Premium, or 105% of all premiums paid).", maturityBenefit: "Basic Sum Assured + Vested Bonus + FAB.", primaryCategory: "Endowment", categories: ["Savings", "Tax-Saving", "Legacy"], why: "Best for disciplined long-term savings with guaranteed returns and life cover." },
        { planName: "Jeevan Labh", planNumber: "736", productSummary: "A limited premium paying, with-profits Endowment plan, offering high bonuses.", minSumAssured: "2,00,000", maxSumAssured: "NO LIMIT", minAge: "8 Years", maxAge: "59 Years", minTerm: "16, 21, or 25 Years", maxTerm: "25 Years", ppt: "10, 15, or 16 Years", deathBenefit: "Higher of BSA, 7x Annual Premium, or 105% of all premiums paid.", maturityBenefit: "Basic Sum Assured + Reversionary Bonus + FAB.", primaryCategory: "Endowment", categories: ["Savings", "Tax-Saving"], why: "Ideal for goal-based savings with shorter premium commitments." },
        { planName: "Single Premium Endowment", planNumber: "717", productSummary: "A one-time investment endowment plan for those who want to avoid recurring payments.", minSumAssured: "1,00,000", maxSumAssured: "NO LIMIT", minAge: "30 Days", maxAge: "65 Years", minTerm: "10 Years", maxTerm: "25 Years", ppt: "Single Premium", deathBenefit: "Sum Assured + Bonus + FAB.", maturityBenefit: "Sum Assured + Vested Bonus + FAB.", primaryCategory: "Single Premium", categories: ["Endowment", "Savings"], why: "Perfect for deploying a lump sum for a future goal with life cover." },
        
        // Whole Life Plans
        { planName: "Jeevan Anand", planNumber: "715", productSummary: "A unique plan combining endowment benefits with whole life cover.", minSumAssured: "2,00,000", maxSumAssured: "NO LIMIT", minAge: "18 Years", maxAge: "50 Years", minTerm: "15 Years", maxTerm: "35 Years", ppt: "Same as Policy Term", deathBenefit: "During term: 125% of SA + Bonuses. After term on death: Basic Sum Assured.", maturityBenefit: "Basic Sum Assured + Vested Bonus + FAB.", primaryCategory: "Whole Life", categories: ["Endowment", "Savings", "Legacy"], why: "Offers a lump sum at maturity and continues life cover until death, creating a legacy." },
        { planName: "Jeevan Umang", planNumber: "745", productSummary: "A whole life plan providing annual survival benefits after PPT and a lump sum at maturity or death.", minSumAssured: "2,00,000", maxSumAssured: "NO LIMIT", minAge: "90 Days", maxAge: "55 Years", minTerm: "(100 - age) Years", maxTerm: "(100 - age) Years", ppt: "15, 20, 25, or 30 Years", deathBenefit: "SA on Death + Bonus + FAB.", maturityBenefit: "8% of SA annually after PPT. At age 100: SA + Bonuses.", primaryCategory: "Whole Life", categories: ["Pension", "Legacy", "Savings", "Retirement"], why: "Excellent for creating a guaranteed, tax-free pension for life and leaving a legacy." },
        { planName: "Jeevan Utsav", planNumber: "771", productSummary: "A whole life plan with guaranteed additions and lifelong income benefits.", minSumAssured: "5,00,000", maxSumAssured: "NO LIMIT", minAge: "90 Days", maxAge: "65 Years", minTerm: "(100 - age) Years", maxTerm: "(100 - age) Years", ppt: "5 to 16 Years", deathBenefit: "SA on Death + Guaranteed Additions.", maturityBenefit: "10% of SA annually for life after deferment. At maturity (age 100) or death, SA + GA paid.", primaryCategory: "Whole Life", categories: ["Pension", "Legacy", "Guaranteed", "Retirement"], why: "Provides lifelong guaranteed income, making it a strong alternative to traditional pensions." },
        
        // Money Back Plans
        { planName: "20Year Money Back", planNumber: "720", productSummary: "A money back plan providing periodic payouts during the policy term.", minSumAssured: "2,00,000", maxSumAssured: "NO LIMIT", minAge: "13 Years", maxAge: "50 Years", minTerm: "20 Years", maxTerm: "20 Years", ppt: "15 Years", deathBenefit: "125% of SA + Bonuses.", maturityBenefit: "Survival: 20% of SA at years 5, 10, 15. Maturity: 40% of SA + Bonus.", primaryCategory: "Money Back", categories: ["Savings", "Life Event"], why: "Provides liquidity at key milestones without compromising on the total life cover." },
        { planName: "Bima Shree", planNumber: "748", productSummary: "A premium money-back plan designed for High Net-worth Individuals.", minSumAssured: "10,00,000", maxSumAssured: "No Limit", minAge: "8 Years", maxAge: "55 Years", minTerm: "14 to 20 Years", maxTerm: "20 Years", ppt: "Term-4 Years", deathBenefit: "125% of SA + GA + LA.", maturityBenefit: "Periodic payouts of 30-45% of BSA depending on the term.", primaryCategory: "HNI", categories: ["Money Back", "Savings"], why: "Caters to high-income individuals needing periodic liquidity and substantial cover." },

        // Children Plans
        { planName: "Jeevan Tarun", planNumber: "734", productSummary: "A flexible money back plan for children's education and other needs.", minSumAssured: "2,00,000", maxSumAssured: "NO LIMIT", minAge: "0 Years", maxAge: "12 Years", minTerm: "Maturity at 25", maxTerm: "Maturity at 25", ppt: "(20 - Age) Years", deathBenefit: "SA on Death + Bonuses.", maturityBenefit: "Flexible options for receiving money back annually from age 20 to 24.", primaryCategory: "Children Plan", categories: ["Money Back", "Savings"], why: "The best choice for funding a child's higher education with flexible payout options." },
        { planName: "Amritbaal", planNumber: "774", productSummary: "A guaranteed additions plan to build a corpus for a child's future needs.", minSumAssured: "2,00,000", maxSumAssured: "NO LIMIT", minAge: "0 Years", maxAge: "13 Years", minTerm: "Maturity at 18-25", maxTerm: "Maturity at 25", ppt: "Single, 5, 6, or 7 Years", deathBenefit: "SA on Death.", maturityBenefit: "Basic Sum Assured + Guaranteed Additions.", primaryCategory: "Children Plan", categories: ["Guaranteed", "Savings"], why: "Ideal for parents who want a guaranteed amount for their child's future without market risk." },
        { planName: "Jeevan Lakshya", planNumber: "733", productSummary: "An endowment plan with a unique benefit that provides annual income on death, ensuring goals like a child's education are met even in the parent's absence.", minSumAssured: "2,00,000", maxSumAssured: "NO LIMIT", minAge: "18 Years", maxAge: "50 Years", minTerm: "13 Years", maxTerm: "25 Years", ppt: "Term - 3 Years", deathBenefit: "Annual Income (10% of BSA) + 110% of BSA at maturity.", maturityBenefit: "Basic Sum Assured + Bonus + FAB.", primaryCategory: "Children Plan", categories: ["Endowment", "Protection"], why: "Uniquely protects a child's future by providing an income stream in case of the parent's demise." },
        
        // Term Plans
        { planName: "New Jeevan Amar", planNumber: "955", productSummary: "A comprehensive and flexible pure risk protection plan.", minSumAssured: "25,00,000", maxSumAssured: "NO LIMIT", minAge: "18 Years", maxAge: "65 Years", minTerm: "10 Years", maxTerm: "40 Years", ppt: "Regular, Limited, Single", deathBenefit: "Level or Increasing Sum Assured options.", maturityBenefit: "None.", primaryCategory: "Term Insurance", categories: ["Protection", "Loan Cover"], why: "Offers high life cover at a very low cost, perfect for pure financial protection." },
        { planName: "Saral Jeevan Bima", planNumber: "859", productSummary: "A standardized, simple pure term insurance plan with standard terms and conditions.", minSumAssured: "5,00,000", maxSumAssured: "25,00,000", minAge: "18 Years", maxAge: "65 Years", minTerm: "5 Years", maxTerm: "40 Years", ppt: "Regular, Limited, Single", deathBenefit: "100% of Basic SA.", maturityBenefit: "None.", primaryCategory: "Term Insurance", categories: ["Protection"], why: "A simple, easy-to-understand term plan for first-time buyers needing basic cover." },
        
        // Pension/Annuity Plans
        { planName: "Jeevan Akshay VII", planNumber: "857", productSummary: "An immediate annuity plan that provides a guaranteed pension for life after a one-time investment.", minSumAssured: "1,00,000 (Purchase Price)", maxSumAssured: "NO LIMIT", minAge: "25 Years", maxAge: "100 Years", minTerm: "Immediate Annuity", maxTerm: "Immediate Annuity", ppt: "Single Premium", deathBenefit: "Depends on option; can include return of purchase price.", maturityBenefit: "None.", primaryCategory: "Pension", categories: ["Annuity", "Retirement", "Single Premium"], why: "The go-to plan for someone who has just retired and wants to convert a lump sum into immediate, lifelong income." },
        { planName: "New Jeevan Shanti", planNumber: "758", productSummary: "A deferred annuity plan where you invest now and start receiving a pension after a few years.", minSumAssured: "1,50,000 (Purchase Price)", maxSumAssured: "NO LIMIT", minAge: "30 Years", maxAge: "79 Years", minTerm: "Deferred Annuity", maxTerm: "Deferred Annuity", ppt: "Single Premium", deathBenefit: "Return of purchase price plus interest.", maturityBenefit: "None.", primaryCategory: "Pension", categories: ["Annuity", "Retirement", "Single Premium"], why: "Perfect for planning retirement a few years in advance, locking in today's annuity rates for a future pension." },
    ];

    const needsToPlanMapping = {
        'income_replacement': ['Term Insurance', 'Whole Life', 'Endowment'],
        'loan_protection': ['Term Insurance', 'Loan Cover'],
        'child_education': ['Children Plan'],
        'wealth_creation': ['Endowment', 'HNI', 'Whole Life'],
        'retirement': ['Pension', 'Retirement', 'Whole Life'],
        'tax_saving': ['Endowment', 'Children Plan', 'Whole Life', 'Money Back'],
        'life_event': ['Money Back', 'Endowment'],
        'risk_coverage': ['Term Insurance', 'Protection'],
        'legacy': ['Legacy', 'Whole Life', 'HNI'],
        'business': ['Term Insurance', 'HNI']
    };

    // --- UI ELEMENT REFERENCES ---
    const needsSelector = document.getElementById('needsSelector');
    const planSuggestionOutput = document.getElementById('planSuggestionOutput');
    const selectors = [document.getElementById('planSelector1'), document.getElementById('planSelector2'), document.getElementById('planSelector3'), document.getElementById('planSelector4'), document.getElementById('planSelector5')];
    const planNumberInputs = [document.getElementById('planNumber1'), document.getElementById('planNumber2'), document.getElementById('planNumber3'), document.getElementById('planNumber4'), document.getElementById('planNumber5')];

    // --- INITIALIZATION ---
    function init() {
        populateNeedsSelector();
        populatePlanSelectors();
        setupEventListeners();
        comparePlans(); // Initial empty table
    }

    // --- EVENT LISTENERS SETUP ---
    function setupEventListeners() {
        needsSelector.addEventListener('change', findBestPlans);
        selectors.forEach((selector, index) => selector.addEventListener('change', () => updatePlanNumber(index)));
        document.getElementById('compareBtn').addEventListener('click', comparePlans);
        document.getElementById('calculatePremiumBtn').addEventListener('click', calculatePremiums);
    }

    // --- FUNCTION DEFINITIONS ---
    function populateNeedsSelector() {
        const needs = [
            { group: 'Financial Protection Needs', items: [ { value: 'income_replacement', text: 'Income replacement for family' }, { value: 'loan_protection', text: 'Covering home/business loans' }, { value: 'child_education', text: 'Funding for Child’s Education' } ]},
            { group: 'Savings & Retirement', items: [ { value: 'wealth_creation', text: 'Long-term savings & wealth creation' }, { value: 'retirement', text: 'Guaranteed pension after retirement' }, { value: 'tax_saving', text: 'Saving tax under Sec 80C' } ]},
            { group: 'Life Events & Legacy', items: [ { value: 'life_event', text: 'Funding key life events (e.g., marriage)' }, { value: 'risk_coverage', text: 'High risk cover at low cost' }, { value: 'legacy', text: 'Leaving a legacy / Inheritance' } ]},
            { group: 'Specialized Needs', items: [ { value: 'business', text: 'Business / Key-person insurance' } ]}
        ];
        let html = '<option value="">-- Please select a need --</option>';
        needs.forEach(cat => {
            html += `<optgroup label="✅ ${cat.group}">`;
            cat.items.forEach(item => { html += `<option value="${item.value}">${item.text}</option>`; });
            html += '</optgroup>';
        });
        needsSelector.innerHTML = html;
    }

    function populatePlanSelectors() {
        const defaultOption = '<option value="">-- Select a Plan --</option>';
        const optionsHTML = planData
            .sort((a, b) => a.planName.localeCompare(b.planName))
            .map(plan => `<option value="${plan.planName}">${plan.planName} (${plan.planNumber})</option>`)
            .join('');
        selectors.forEach(selector => selector.innerHTML = defaultOption + optionsHTML);
    }
    
    function findBestPlans() {
        const selectedNeed = needsSelector.value;
        planSuggestionOutput.innerHTML = '';

        if (!selectedNeed) {
            planSuggestionOutput.innerHTML = '<p style="text-align:center; color:#777; grid-column: 1 / -1;">Top 3 recommended plans will appear here.</p>';
            return;
        }

        const targetCategories = needsToPlanMapping[selectedNeed] || [];
        
        // Prioritize plans where the primary category matches
        const primaryMatches = planData.filter(plan => targetCategories.includes(plan.primaryCategory));
        
        // Get other plans that fit secondary categories, excluding primary matches
        const secondaryMatches = planData.filter(plan => 
            !primaryMatches.includes(plan) && plan.categories.some(cat => targetCategories.includes(cat))
        );

        // Combine and get the top 3
        const recommendedPlans = [...primaryMatches, ...secondaryMatches].slice(0, 3);

        if (recommendedPlans.length === 0) {
            planSuggestionOutput.innerHTML = '<p style="text-align:center; color:#777; grid-column: 1 / -1;">No specific plans match this need. Consider a general endowment or term plan.</p>';
            return;
        }

        recommendedPlans.forEach(plan => {
            const card = document.createElement('div');
            card.className = 'suggestion-card';
            card.innerHTML = `
                <h3>${plan.planName} (${plan.planNumber})</h3>
                <p><strong>Overall Plan Details:</strong> ${plan.productSummary}</p>
                <div class="why-reason"><strong>Best Fit For:</strong> ${plan.why}</div>
            `;
            planSuggestionOutput.appendChild(card);
        });
    }

    function generateIllustrativeExample(plan) {
        if (!plan) return "-";
        const sa = plan.primaryCategory === 'HNI' ? '50 Lakh' : (plan.primaryCategory === 'Term Insurance' ? '1 Crore' : '10 Lakh');
        
        // Using plan numbers for reliable identification
        switch (plan.planNumber) {
            case '714': // New Endowment
            case '736': // Jeevan Labh
            case '768': // Jeevan Azad
            case '760': // Bima Jyoti
                return `Mr. Sharma, age 30, buys a ${sa} policy for 25 years. He pays premiums for the specified PPT. On survival, he receives ${sa} + bonuses. If he passes away during the term, his family receives ${sa} + accrued bonuses.`;
            case '715': // Jeevan Anand
                return `Ms. Desai, age 35, takes a ${sa} policy for 20 years. On surviving 20 years, she receives ${sa} + bonuses. The risk cover continues, and on her death anytime later, her family receives an additional ${sa}.`;
            case '745': // Jeevan Umang
            case '771': // Jeevan Utsav
                return `Mr. Kumar, age 40, buys a ${sa} policy with a 15-year PPT. After 15 years, he starts receiving a guaranteed annual pension for life. On his death, his nominee receives a large lump sum.`;
            case '720': // 20Yr Money Back
            case '721': // 25Yr Money Back
            case '748': // Bima Shree
                return `Ms. Gupta, age 35, takes a ${sa} policy. She receives periodic payouts during the term for key life events. The full life cover remains active throughout, and she gets a final amount at maturity.`;
            case '734': // Jeevan Tarun
            case '732': // Child Money Back
            case '774': // Amritbaal
                return `A parent buys a ${sa} policy for their 2-year-old child. The plan provides annual payouts when the child turns 20, 21, 22, and 23 for college fees, with a final lump sum at age 25 for post-graduation.`;
            case '733': // Jeevan Lakshya
                return `Mr. Singh buys this plan for his daughter's wedding. If he passes away, the plan pays a regular income to the family for expenses, waives future premiums, and still pays the full maturity amount on the planned date.`;
            case '955': // New Jeevan Amar
            case '859': // Saral Jeevan Bima
                return `Mr. Khan, a 28-year-old professional, buys a ${sa} policy for a 30-year term to protect his family. If he passes away within these 30 years, his family receives the full ${sa}. If he survives the term, no amount is paid.`;
            case '857': // Jeevan Akshay VII
            case '862': // Saral Pension
                return `Mrs. Rao, age 60, invests a lump sum of 20 Lakh. She immediately starts receiving a guaranteed pension for the rest of her life. Depending on the option, the initial 20 Lakh can be returned to her nominee upon her death.`;
            default:
                return "This is a specialized plan. An example can be provided upon request.";
        }
    }
    
    function comparePlans() {
        const tableHead = document.getElementById('comparisonTableHead');
        const tableBody = document.getElementById('comparisonTableBody');
        
        let selectedPlans = [];
        let headerHTML = '<tr><th>Feature</th>';
        let hasSelection = false;

        selectors.forEach(selector => {
            const planName = selector.value;
            if (planName) {
                hasSelection = true;
                const plan = planData.find(p => p.planName === planName);
                selectedPlans.push(plan);
                headerHTML += `<th>${plan.planName} (${plan.planNumber})</th>`;
            } else {
                 selectedPlans.push(null);
                 headerHTML += `<th>-</th>`;
            }
        });
        headerHTML += '</tr>';
        tableHead.innerHTML = headerHTML;

        let initialMessage = '<tr><td colspan="6" style="text-align:center;">Please select at least one plan to see the comparison.</td></tr>';
        if (!hasSelection) {
            tableBody.innerHTML = initialMessage;
            return;
        }

        const features = [
            { key: 'minSumAssured', label: 'Min Sum Assured' }, { key: 'maxSumAssured', label: 'Max Sum Assured' },
            { key: 'minAge', label: 'Min Entry Age' }, { key: 'maxAge', label: 'Max Entry Age' },
            { key: 'minTerm', label: 'Min/Max Policy Term' }, 
            { key: 'ppt', label: 'Premium Paying Term (PPT)' }, { key: 'deathBenefit', label: 'Death Benefit' },
            { key: 'maturityBenefit', label: 'Maturity/Survival Benefit' },
            { key: 'illustrativeExample', label: 'Illustrative Example' }
        ];

        let bodyHTML = '';
        features.forEach(feature => {
            bodyHTML += `<tr><th>${feature.label}</th>`;
            selectedPlans.forEach(plan => {
                let cellContent = '-';
                if (plan) {
                    if (feature.key === 'illustrativeExample') {
                        cellContent = `<div class="illustrative-example">${generateIllustrativeExample(plan)}</div>`;
                    } else if (feature.key === 'minTerm') {
                        cellContent = `${plan.minTerm}` + (plan.maxTerm !== plan.minTerm ? ` to ${plan.maxTerm}` : '');
                    } else {
                        cellContent = plan[feature.key] || '-';
                    }
                }
                bodyHTML += `<td>${cellContent}</td>`;
            });
            bodyHTML += '</tr>';
        });

        tableBody.innerHTML = bodyHTML;
    }

    function updatePlanNumber(index) {
        const selectedPlanName = selectors[index].value;
        const plan = planData.find(p => p.planName === selectedPlanName);
        planNumberInputs[index].value = plan ? plan.planNumber : '';
    }

    function calculatePremiums() {
        alert("Premium Calculator - Functional Mockup\n\nThis UI is fully functional, but real premium calculation is not possible without the official, complex premium rate tables from LIC. This feature is a placeholder to demonstrate how it would work.");
        for(let i=1; i<=5; i++){ document.getElementById(`premiumOutput${i}`).value = 'N/A'; }
    }

    // Run the app
    init();
});
</script>

</body>
</html>